#N canvas 944 161 312 367 10;
#X declare -path ../abs;
#X declare -lib jasch_lib;
#X text -40 310 https://github.com/angelfaraldo/pd-symbolic;
#X text -40 325 angel.faraldo@upf.edu ----- Barcelona \, 2015;
#X obj 34 1 netreceive 3006 0 old;
#X obj -40 1 path ../abs;
#X obj -40 21 import jasch_lib;
#N canvas 105 258 415 412 gem_visualization 0;
#X msg 12 57 0 \, destroy;
#X floatatom 50 129 5 0 0 0 - - -;
#X msg 5 35 reset \, dimen 800 150 \, title Loop \, create \, 1;
#N canvas 283 87 463 657 grid 0;
#X obj 14 79 vis/grid-beat-strong;
#X obj 14 143 vis/grid-beat-soft;
#X obj 14 163 vis/grid-beat-soft;
#X obj 14 183 vis/grid-beat-soft;
#X obj 14 307 vis/grid-beat-soft;
#X obj 14 327 vis/grid-beat-soft;
#X obj 14 347 vis/grid-beat-soft;
#X obj 14 473 vis/grid-beat-soft;
#X obj 14 493 vis/grid-beat-soft;
#X obj 14 513 vis/grid-beat-soft;
#X obj 14 637 vis/grid-beat-soft;
#X obj 14 657 vis/grid-beat-soft;
#X obj 14 677 vis/grid-beat-soft;
#X obj 14 14 inlet;
#X obj 14 35 color 1 0 0 0.4;
#X obj 14 246 vis/grid-beat-strong;
#X obj 14 412 vis/grid-beat-strong;
#X obj 14 576 vis/grid-beat-strong;
#X obj 14 100 color 1 1 1 0.4;
#X obj 14 205 color 0 1 0 0.4;
#X obj 14 267 color 1 1 1 0.4;
#X obj 14 371 color 0 1 0 0.4;
#X obj 14 433 color 1 1 1 0.4;
#X obj 14 535 color 0 1 0 0.4;
#X obj 14 597 color 1 1 1 0.4;
#X obj 14 226 alpha 1;
#X obj 14 286 alpha 1;
#X obj 14 391 alpha 1;
#X obj 14 453 alpha 1;
#X obj 14 556 alpha 1;
#X obj 14 617 alpha 1;
#X obj 14 122 alpha 1;
#X obj 14 57 alpha 1;
#X obj 124 79 vis/grid-beat-strong;
#X obj 124 143 vis/grid-beat-soft;
#X obj 124 163 vis/grid-beat-soft;
#X obj 124 183 vis/grid-beat-soft;
#X obj 124 307 vis/grid-beat-soft;
#X obj 124 327 vis/grid-beat-soft;
#X obj 124 347 vis/grid-beat-soft;
#X obj 124 473 vis/grid-beat-soft;
#X obj 124 493 vis/grid-beat-soft;
#X obj 124 513 vis/grid-beat-soft;
#X obj 124 637 vis/grid-beat-soft;
#X obj 124 657 vis/grid-beat-soft;
#X obj 124 677 vis/grid-beat-soft;
#X obj 124 35 color 1 0 0 0.4;
#X obj 124 246 vis/grid-beat-strong;
#X obj 124 412 vis/grid-beat-strong;
#X obj 124 576 vis/grid-beat-strong;
#X obj 124 100 color 1 1 1 0.4;
#X obj 124 205 color 0 1 0 0.4;
#X obj 124 267 color 1 1 1 0.4;
#X obj 124 371 color 0 1 0 0.4;
#X obj 124 433 color 1 1 1 0.4;
#X obj 124 535 color 0 1 0 0.4;
#X obj 124 597 color 1 1 1 0.4;
#X obj 124 226 alpha 1;
#X obj 124 286 alpha 1;
#X obj 124 391 alpha 1;
#X obj 124 453 alpha 1;
#X obj 124 556 alpha 1;
#X obj 124 617 alpha 1;
#X obj 124 122 alpha 1;
#X obj 124 57 alpha 1;
#X obj 254 79 vis/grid-beat-strong;
#X obj 254 35 color 1 0 0 0.4;
#X obj 254 57 alpha 1;
#X connect 0 0 18 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 19 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 21 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 9 0 23 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 46 0;
#X connect 13 0 14 0;
#X connect 14 0 32 0;
#X connect 15 0 20 0;
#X connect 16 0 22 0;
#X connect 17 0 24 0;
#X connect 18 0 31 0;
#X connect 19 0 25 0;
#X connect 20 0 26 0;
#X connect 21 0 27 0;
#X connect 22 0 28 0;
#X connect 23 0 29 0;
#X connect 24 0 30 0;
#X connect 25 0 15 0;
#X connect 26 0 4 0;
#X connect 27 0 16 0;
#X connect 28 0 7 0;
#X connect 29 0 17 0;
#X connect 30 0 10 0;
#X connect 31 0 1 0;
#X connect 32 0 0 0;
#X connect 33 0 50 0;
#X connect 34 0 35 0;
#X connect 35 0 36 0;
#X connect 36 0 51 0;
#X connect 37 0 38 0;
#X connect 38 0 39 0;
#X connect 39 0 53 0;
#X connect 40 0 41 0;
#X connect 41 0 42 0;
#X connect 42 0 55 0;
#X connect 43 0 44 0;
#X connect 44 0 45 0;
#X connect 45 0 66 0;
#X connect 46 0 64 0;
#X connect 47 0 52 0;
#X connect 48 0 54 0;
#X connect 49 0 56 0;
#X connect 50 0 63 0;
#X connect 51 0 57 0;
#X connect 52 0 58 0;
#X connect 53 0 59 0;
#X connect 54 0 60 0;
#X connect 55 0 61 0;
#X connect 56 0 62 0;
#X connect 57 0 47 0;
#X connect 58 0 37 0;
#X connect 59 0 48 0;
#X connect 60 0 40 0;
#X connect 61 0 49 0;
#X connect 62 0 43 0;
#X connect 63 0 34 0;
#X connect 64 0 33 0;
#X connect 66 0 67 0;
#X connect 67 0 65 0;
#X restore 7 171 pd grid;
#X obj 7 149 translateXYZ -19.5 0 0;
#N canvas 519 185 302 504 current-step 0;
#X obj 61 281 * 0.5;
#X obj 36 328 translateXYZ 0.75 0 0;
#X obj 79 166 * 1.2;
#X obj 61 303 * 1.2;
#X obj 79 190 - 19.5;
#X obj 36 211 translateXYZ -19.5 0 0;
#X obj 36 400 rectangle 0.75 3;
#X obj 61 237 loadbang;
#X obj 66 39 r current_step;
#X obj 56 84 mod 4;
#X msg 61 259 4;
#X obj 56 105 sel 0;
#X obj 66 60 t f f;
#X obj 99 142 f;
#X obj 36 17 gemhead 51;
#X obj 36 376 alpha 0;
#X obj 36 349 color 0.2 0.2 0.2 0.8;
#X connect 0 0 3 0;
#X connect 1 0 16 0;
#X connect 2 0 4 0;
#X connect 3 0 1 1;
#X connect 3 0 6 1;
#X connect 4 0 5 1;
#X connect 5 0 1 0;
#X connect 7 0 10 0;
#X connect 8 0 12 0;
#X connect 9 0 11 0;
#X connect 10 0 0 0;
#X connect 11 0 13 0;
#X connect 12 0 9 0;
#X connect 12 1 13 1;
#X connect 13 0 2 0;
#X connect 14 0 5 0;
#X connect 15 0 6 0;
#X connect 16 0 15 0;
#X restore 7 193 pd current-step;
#X obj 5 80 gemwin 20;
#X obj 7 107 gemhead 50;
#X obj 6 215 vis/master-chord-event 0;
#X obj 6 235 vis/master-chord-event 1;
#X obj 6 255 vis/master-chord-event 2;
#X obj 6 275 vis/master-chord-event 3;
#X obj 6 295 vis/master-chord-event 4;
#X obj 6 315 vis/master-chord-event 5;
#X obj 6 335 vis/master-chord-event 6;
#X obj 6 355 vis/master-chord-event 7;
#X obj 175 227 vis/slave-chord-event 0 15 CM7;
#X obj 175 247 vis/slave-chord-event 17 14 G9;
#X obj 5 -9 loadbang;
#X obj 5 12 delay 500;
#X connect 0 0 6 0;
#X connect 1 0 4 1;
#X connect 2 0 6 0;
#X connect 4 0 3 0;
#X connect 7 0 4 0;
#X connect 18 0 19 0;
#X connect 19 0 2 0;
#X restore -40 41 pd gem_visualization;
#N canvas 438 330 587 397 midi_analysis 0;
#X obj -204 -104 r reset-analysis;
#X msg -266 -39 flush;
#X obj -260 160 / 4;
#X obj -296 113 unpack 0 0 0 0 0;
#X obj -227 158 s ticks/4;
#X obj -266 -17 t a b;
#X obj -195 0 s reset-analysis;
#X obj -266 -103 openpanel;
#X msg -266 -83 read \$1;
#X obj -209 27 midi_player;
#X obj -128 112 s end-analysis;
#X obj -152 134 sort-midi;
#X msg -266 -137 symbol ./Git/pd-symbolic/testfiles/midi-chord-loops/2b-homophonic
;
#X obj -266 -158 r load_midi_file;
#X obj -128 90 t b b;
#X obj -203 134 s tempo;
#X obj -260 138 uanz;
#X obj -266 -62 t b a;
#X obj -260 181 s bars;
#X obj 151 -50 r tempo;
#X obj 207 -25 r bars;
#X obj 96 -46 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X msg 96 -25 play \$1;
#N canvas 297 222 551 577 midi-loop-player 0;
#X obj 93 64 route play;
#X obj 187 119 /;
#X obj 187 73 inlet;
#X obj 63 107 sel 0;
#X obj 93 43 inlet;
#X obj 251 72 inlet;
#X obj 251 93 * 16;
#X obj 166 176 + 1;
#X obj 136 144 metro 500;
#X obj 251 117 + 1;
#X obj 136 176 f 0;
#X msg 238 212 0;
#X msg 63 132 0;
#X floatatom 268 184 5 0 0 0 - - -;
#X msg 187 96 15000 \$1;
#X obj 214 397 tabread fill-onsets;
#X obj 185 256 panic;
#X obj 136 256 outlet;
#X floatatom 331 131 5 0 0 0 - - -;
#X obj 185 234 sel 0 31;
#X obj 136 211 t f f;
#X connect 0 0 3 0;
#X connect 0 0 8 0;
#X connect 1 0 8 1;
#X connect 1 0 13 0;
#X connect 2 0 14 0;
#X connect 3 0 12 0;
#X connect 4 0 0 0;
#X connect 5 0 6 0;
#X connect 6 0 9 0;
#X connect 7 0 10 1;
#X connect 8 0 10 0;
#X connect 10 0 7 0;
#X connect 10 0 20 0;
#X connect 11 0 10 1;
#X connect 12 0 10 1;
#X connect 14 0 1 0;
#X connect 18 0 8 1;
#X connect 19 0 16 0;
#X connect 19 1 11 0;
#X connect 20 0 17 0;
#X connect 20 1 19 0;
#X restore 96 -3 pd midi-loop-player;
#X floatatom 158 -26 5 0 0 0 - - -;
#X obj -82 -11 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X msg -82 10 play \$1 \, loop 1;
#X obj -35 107 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj -313 24 noteout;
#X msg -204 -82 \; fill-pattern const -1 \; fill-onsets const 0 \;
;
#X obj 96 44 s current_step;
#X floatatom 107 22 5 0 0 0 - - -;
#X floatatom 217 -59 5 0 0 0 - - -;
#N canvas 239 111 742 666 get-chord-progression 0;
#X obj -110 4 inlet;
#X obj -233 116 midi_chord_estimator;
#X obj -233 95 make_chord;
#X obj -35 43 unpack 0 0 0 0;
#X obj -35 87 /;
#X obj -20 65 r ticks/4;
#X obj 19 88 != 0;
#X obj -35 108 * 4;
#X obj -140 136 r reset-analysis;
#X obj 210 101 route;
#X obj 210 66 t l f;
#X obj -35 130 pack;
#X obj -35 151 change_pack;
#X obj 210 130 tabwrite fill-pattern;
#X obj 227 152 tabwrite fill-onsets;
#X obj 344 93 - 1;
#X obj 356 152 table fill-onsets 32;
#X obj 357 130 table fill-pattern 32;
#X obj -110 26 t l l;
#X obj -233 156 add2list prepend;
#X msg -35 172 \$2 \$1;
#X obj -35 242 add2list prepend;
#X obj 118 182 r reset-analysis;
#X obj -35 284 list length;
#X obj -233 200 list length;
#X obj -193 236 ==;
#X obj -193 258 sel 1;
#X obj -227 316 list;
#X obj -233 179 t l l;
#X obj -35 262 t l l;
#X obj -158 314 list;
#X obj -227 336 drip 0;
#X obj -158 335 drip 0;
#X obj -35 193 route 1 0;
#X obj 72 242 add2list prepend;
#X obj -74 313 list;
#X obj -74 336 drip 0;
#X obj -193 280 t b b b;
#X obj -95 410 -;
#X obj -95 386 swap;
#X obj -158 356 t f f;
#X text 37 322 listfind para a√±adir 32 0 en caso de que no este presente
;
#X obj -152 436 pack s f f;
#X obj -47 387 f 0;
#X obj -17 387 + 1;
#X obj -47 412 mod 8;
#X obj -74 363 t f b;
#X obj -152 472 s;
#X obj -47 438 makefilename master-chord-fill-%d;
#X msg 216 371 \; master-chord-fill-0 C 100 1 \; master-chord-fill-1
C 100 1 \; master-chord-fill-2 C 100 1 \; master-chord-fill-3 C 100
1 \; master-chord-fill-4 C 100 1 \; master-chord-fill-5 C 100 1 \;
master-chord-fill-6 C 100 1 \; master-chord-fill-7 C 100 1;
#X obj 216 349 r reset-analysis;
#X connect 0 0 18 0;
#X connect 1 0 19 0;
#X connect 2 0 1 0;
#X connect 3 0 4 0;
#X connect 3 2 6 0;
#X connect 4 0 7 0;
#X connect 5 0 4 1;
#X connect 6 0 11 1;
#X connect 7 0 11 0;
#X connect 8 0 19 1;
#X connect 9 0 14 0;
#X connect 9 0 13 0;
#X connect 10 0 9 0;
#X connect 10 1 9 1;
#X connect 10 1 15 0;
#X connect 11 0 12 0;
#X connect 12 0 10 0;
#X connect 12 0 20 0;
#X connect 15 0 14 1;
#X connect 15 0 13 1;
#X connect 18 0 2 0;
#X connect 18 1 3 0;
#X connect 19 0 28 0;
#X connect 20 0 33 0;
#X connect 21 0 29 0;
#X connect 22 0 21 1;
#X connect 22 0 34 1;
#X connect 23 0 25 1;
#X connect 24 0 25 0;
#X connect 25 0 26 0;
#X connect 26 0 37 0;
#X connect 27 0 31 0;
#X connect 28 0 24 0;
#X connect 28 1 27 1;
#X connect 29 0 23 0;
#X connect 29 1 30 1;
#X connect 30 0 32 0;
#X connect 31 0 42 0;
#X connect 32 0 40 0;
#X connect 33 0 21 0;
#X connect 33 1 34 0;
#X connect 34 0 35 1;
#X connect 35 0 36 0;
#X connect 36 0 46 0;
#X connect 37 0 27 0;
#X connect 37 1 30 0;
#X connect 37 2 35 0;
#X connect 38 0 42 2;
#X connect 39 0 38 0;
#X connect 39 1 38 1;
#X connect 40 0 42 1;
#X connect 40 1 39 0;
#X connect 42 0 47 0;
#X connect 43 0 44 0;
#X connect 43 0 45 0;
#X connect 44 0 43 1;
#X connect 45 0 48 0;
#X connect 46 0 39 1;
#X connect 46 1 43 0;
#X connect 48 0 47 1;
#X connect 50 0 49 0;
#X restore -152 158 pd get-chord-progression;
#X connect 0 0 29 0;
#X connect 1 0 5 0;
#X connect 2 0 18 0;
#X connect 3 0 16 0;
#X connect 3 3 4 0;
#X connect 3 4 15 0;
#X connect 5 0 9 0;
#X connect 5 1 6 0;
#X connect 5 1 16 1;
#X connect 7 0 8 0;
#X connect 8 0 17 0;
#X connect 9 0 28 0;
#X connect 9 1 11 0;
#X connect 9 2 3 0;
#X connect 9 3 14 0;
#X connect 11 0 33 0;
#X connect 12 0 7 0;
#X connect 13 0 12 0;
#X connect 14 0 10 0;
#X connect 14 1 11 1;
#X connect 14 1 27 0;
#X connect 16 0 2 0;
#X connect 17 0 1 0;
#X connect 17 1 9 0;
#X connect 19 0 23 1;
#X connect 20 0 23 2;
#X connect 21 0 22 0;
#X connect 22 0 23 0;
#X connect 23 0 30 0;
#X connect 23 0 31 0;
#X connect 24 0 23 1;
#X connect 25 0 26 0;
#X connect 26 0 9 0;
#X connect 32 0 23 2;
#X restore 64 21 pd midi_analysis;
#X obj -35 126 r tempo;
#X obj 95 206 r bars;
#X floatatom -35 147 5 0 0 0 - - -;
#X floatatom 103 249 5 0 0 0 - - -;
#X floatatom -34 236 5 0 0 0 - - -;
#X obj 49 184 r allow_inversion;
#X floatatom 49 207 5 0 0 0 - - -;
#X obj -37 73 r substitution;
#X floatatom -38 100 5 0 0 0 - - -;
#X floatatom 39 151 5 0 0 0 - - -;
#X obj 20 108 r activity;
#X obj 100 74 r color;
#X floatatom 100 105 5 0 0 0 - - -;
#X floatatom -36 288 5 0 0 0 - - -;
#X obj -32 264 r register;
#N canvas 784 495 324 195 adt 0;
#X obj 13 55 r density;
#X obj 13 130 list append;
#X obj 13 81 populate_rhythm;
#X obj 76 105 populate_rhythm;
#X obj 100 34 tabdump fill-onsets;
#X obj 100 11 r end-analysis;
#X obj 100 57 list split 16;
#X obj 13 155 s slave-onsets;
#X connect 0 0 2 0;
#X connect 0 0 3 0;
#X connect 1 0 7 0;
#X connect 2 0 1 0;
#X connect 3 0 1 1;
#X connect 4 0 6 0;
#X connect 5 0 4 0;
#X connect 6 0 2 1;
#X connect 6 1 3 1;
#X restore 88 41 pd adt;
#X obj -34 210 r density;
#X obj -33 188 s density;
#X floatatom -33 168 5 0 0 0 - - -;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 12 0 13 0;
#X connect 14 0 15 0;
#X connect 17 0 16 0;
#X connect 18 0 19 0;
#X connect 21 0 20 0;
#X connect 23 0 11 0;
#X connect 25 0 24 0;
